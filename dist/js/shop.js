(()=>{"use strict";const t=async()=>{const t=await fetch("https://marchodb-45caa-default-rtdb.firebaseio.com/goods.json");return await t.json()},e=async({display:e,stack:n,selectorWrap:i,sordetData:r,paginatedData:c})=>{const s=document.querySelector(i);let a;const o=t=>{s.innerHTML="",t.forEach((t=>{s.insertAdjacentHTML("beforeend",`\n            <div class="product-item">\n                <div class="product-item__id">${t.id}</div>\n                    <div class="product-item__img-box">\n                    ${t.discount?`<div class="product-item__discount">${t.discount}</div>`:""}\n                    <img class="product-item__images" src="${Array.isArray(t.images)?t.images[0]:t.images}" alt="product">\n                        <div class="product-item__link-box">    \n                            <a class="product-item__link product-link" href="product.html">\n                                <svg width="19px" height="20px">\n                                    <path fill-rule="evenodd" fill="rgb(41, 40, 45)" d="M18.709,18.219 L14.028,13.269 C15.231,11.813 15.891,9.982 15.891,8.075 C15.891,3.622 12.328,-0.002 7.947,-0.002 C3.568,-0.002 0.005,3.622 0.005,8.075 C0.005,12.529 3.568,16.153 7.947,16.153 C9.591,16.153 11.160,15.649 12.498,14.690 L17.216,19.680 C17.414,19.890 17.678,20.004 17.964,20.004 C18.232,20.004 18.486,19.899 18.680,19.710 C19.093,19.307 19.105,18.639 18.709,18.219 L18.709,18.219 ZM7.947,2.106 C11.185,2.106 13.819,4.785 13.819,8.075 C13.819,11.367 11.185,14.046 7.947,14.046 C4.711,14.046 2.078,11.367 2.078,8.075 C2.078,4.785 4.711,2.106 7.947,2.106 L7.947,2.106 Z"></path>\n                                </svg>\n                            </a>\n                            <a class="product-item__link product-item__link--line basket-link" href="#">\n                                <svg width="16px" height="20px">\n                                    <path fill-rule="evenodd" fill="rgb(41, 40, 45)" d="M15.999,17.294 L14.854,4.396 C14.830,4.109 14.589,3.892 14.307,3.892 L11.953,3.892 C11.920,1.740 10.163,0.002 8.005,0.002 C5.847,0.002 4.090,1.740 4.057,3.892 L1.703,3.892 C1.417,3.892 1.180,4.109 1.156,4.396 L0.011,17.294 C0.011,17.311 0.007,17.327 0.007,17.343 C0.007,18.812 1.352,20.006 3.007,20.006 L13.003,20.006 C14.658,20.006 16.003,18.812 16.003,17.343 C16.003,17.327 16.003,17.311 15.999,17.294 L15.999,17.294 ZM8.005,1.106 C9.554,1.106 10.817,2.350 10.849,3.892 L5.161,3.892 C5.193,2.350 6.456,1.106 8.005,1.106 L8.005,1.106 ZM13.003,18.902 L3.007,18.902 C1.969,18.902 1.127,18.215 1.111,17.368 L2.206,5.001 L4.053,5.001 L4.053,6.678 C4.053,6.985 4.298,7.230 4.605,7.230 C4.911,7.230 5.157,6.985 5.157,6.678 L5.157,5.001 L10.849,5.001 L10.849,6.678 C10.849,6.985 11.095,7.230 11.401,7.230 C11.708,7.230 11.953,6.985 11.953,6.678 L11.953,5.001 L13.800,5.001 L14.899,17.368 C14.883,18.215 14.037,18.902 13.003,18.902 L13.003,18.902 Z"></path>\n                                </svg>\n                            </a>\n                            <a class="product-item__link" href="#">\n                                <svg width="23px" height="20px">\n                                    <path fill-rule="evenodd" fill="rgb(41, 40, 45)" d="M16.894,-0.001 C14.470,-0.001 12.935,1.423 12.074,2.618 C11.851,2.929 11.661,3.239 11.501,3.532 C11.342,3.239 11.152,2.929 10.928,2.618 C10.068,1.423 8.533,-0.001 6.108,-0.001 C4.384,-0.001 2.810,0.697 1.675,1.964 C0.593,3.172 -0.004,4.791 -0.004,6.521 C-0.004,8.405 0.744,10.157 2.349,12.034 C3.783,13.713 5.847,15.443 8.236,17.447 C9.127,18.193 10.047,18.965 11.028,19.809 L11.057,19.834 C11.184,19.944 11.343,19.999 11.501,19.999 C11.660,19.999 11.818,19.944 11.945,19.834 L11.975,19.809 C12.955,18.965 13.876,18.193 14.766,17.447 C17.156,15.443 19.219,13.713 20.653,12.034 C22.258,10.157 23.006,8.405 23.006,6.521 C23.006,4.791 22.410,3.172 21.327,1.964 C20.192,0.696 18.618,-0.001 16.894,-0.001 ZM13.892,16.437 C13.124,17.080 12.334,17.743 11.501,18.455 C10.668,17.743 9.878,17.081 9.111,16.437 C4.434,12.516 1.345,9.926 1.345,6.521 C1.345,5.114 1.821,3.806 2.687,2.840 C3.562,1.863 4.777,1.325 6.108,1.325 C7.957,1.325 9.151,2.445 9.828,3.385 C10.435,4.228 10.752,5.078 10.860,5.404 C10.951,5.677 11.209,5.862 11.501,5.862 C11.793,5.862 12.052,5.677 12.142,5.404 C12.250,5.078 12.567,4.228 13.174,3.385 C13.851,2.445 15.046,1.325 16.894,1.325 C18.225,1.325 19.440,1.863 20.316,2.840 C21.181,3.806 21.658,5.114 21.658,6.521 C21.658,9.926 18.568,12.516 13.892,16.437 Z"></path>\n                                </svg>\n                            </a>\n                        </div>\n                    </div>\n                    <div class="product-item__wrapper-box">\n                        <div class="product-item__box">\n                            <div class="product-item__category">${t.category}</div>\n                            <h4 class="product-item__title">${t.name}</h4>\n                            <div class="product-item__price">\n                                <div class="product-item__new-price">${t.price?t.price.trim()+" тг":"unkown"}</div>\n                                <div class="product-item__old-price">${t.priceOld?t.priceOld.trim()+" тг":"unkown"}</div>\n                            </div>\n                        </div>\n                        <div class="product-item__content-box">\n                            <button class="product-item__btn">Добавить в карзину</button>\n                        </div>\n                    </div>\n                    </div>`)}))};c&&o(c),r&&o(r.slice(0,n)),a=await t(),"main"!==e&&"shop"!==e||o(a.slice(0,n))},n=()=>{document.querySelectorAll(".product-item").forEach((t=>t.classList.toggle("product-item--list")))},i=t=>{const e=document.querySelector(".button-grid"),i=document.querySelector(".button-list"),r=()=>{e.classList.toggle("shop-content__filter-btn--active"),i.classList.toggle("shop-content__filter-btn--active"),n()},c=(t,n)=>{e.disabled=t,i.disabled=n};t?(e.classList.add("shop-content__filter-btn--active"),i.classList.remove("shop-content__filter-btn--active"),c(!0,!1)):(e.addEventListener("click",(()=>{r(),c(!0,!1)})),i.addEventListener("click",(()=>{r(),c(!1,!0)})))};e({display:"shop",stack:10,selectorWrap:".shop-content__inner"}),i(),(async()=>{const i=document.querySelector(".pagination"),r=await t(),c=Math.ceil(r.length/10);let s=1;const a=t=>{const e=document.querySelectorAll(".pagination__link");e.forEach((t=>t.classList.remove("pagination__link--active"))),e[t-1].classList.add("pagination__link--active")},o=(t,i,r)=>{const c=i*--r,s=c+i,a=t.slice(c,s);e({selectorWrap:".shop-content__inner",paginatedData:a}),document.querySelector(".button-list").classList.contains("shop-content__filter-btn--active")&&n()};i.addEventListener("click",(t=>{t.preventDefault();const e=t.target;e.classList.contains("pagination__link")&&(o(r,10,e.textContent),s=e.textContent,a(e.textContent)),e.classList.contains("pagination__next")&&s<c&&(o(r,10,++s),a(s)),e.classList.contains("pagination__prev")&&s>1&&(o(r,10,--s),a(s))})),(()=>{const t=document.querySelector(".pagination__list");for(let e=1;e<=c;e++)t.insertAdjacentHTML("beforeend",`\n                <li class="pagination__item">\n                    <a class="pagination__link" href="#">${e}</a>\n                </li>`),1===e&&document.querySelector(".pagination__link").classList.add("pagination__link--active")})()})(),(async()=>{const n=await t();let r=n;const c=(t,c,s,a,o)=>{const l=document.getElementById(t);let d=[];l.addEventListener("change",(t=>{const l=t.target.closest(a).querySelector(c),_=l.parentNode.querySelector(s).textContent.trim();l.checked?n.forEach((t=>{t[o]===_&&d.push(t)})):d.forEach(((t,e)=>{t[o]==_&&delete d[e]})),i(!0),e({selectorWrap:".shop-content__inner",sordetData:d}),0===document.querySelector(".shop-content__inner").childElementCount&&e({selectorWrap:".shop-content__inner",stack:10,sordetData:r})}))};(()=>{const t=document.querySelector(".filter-search__form");document.querySelector(".filter-search__btn").disabled=!0,t.addEventListener("input",(t=>{r=n.filter((e=>{const n=e.name.toLowerCase().includes(t.target.value.toLowerCase()),i=e.category.toLowerCase().includes(t.target.value.toLowerCase());return n||i||void 0})),t.target.value?(i(!0),e({selectorWrap:".shop-content__inner",sordetData:r})):(r=n,e({selectorWrap:".shop-content__inner",stack:10,sordetData:r}))}))})(),(()=>{const t=document.querySelector(".filter-price__form"),c=t.querySelector("#min"),s=t.querySelector("#max"),a=t.querySelector(".filter-price__from"),o=t.querySelector(".filter-price__to");let l,d;const _=t=>t.toLocaleString("ru"),p=t=>t.replace(/\s+/g,"");t.addEventListener("input",(t=>{t.preventDefault(),"min"===t.target.id?(l=p(t.target.value),a.textContent=_(+l)):"max"===t.target.id&&(d=p(t.target.value),o.textContent=_(+d)),c.value||s.value||(r=n,e({selectorWrap:".shop-content__inner",stack:10,sordetData:r})),i(!0),a.textContent||(a.textContent=0),o.textContent||(o.textContent=0)})),t.addEventListener("submit",(t=>{t.preventDefault(),r=r.filter((t=>{if(+p(t.price)>=l&&+p(t.price)<=d)return t})),r[0]||(r=n),i(!0),e({selectorWrap:".shop-content__inner",stack:10,sordetData:r})}))})(),c("filter-size",".filter-size__input",".filter-size__text",".filter-size__label","size"),c("filter-category",".filter-category__input",".filter-category__checkbox",".filter-category__label","category"),c("filter-gender",".filter-popular__input",".filter-popular__checkbox",".filter-popular__label","gender")})(),(async()=>{const e=await t(),n=new Set,i=new Set,r=new Set;e.forEach((t=>{t.size&&n.add(t.size),t.category&&i.add(t.category),t.gender&&r.add(t.gender)}));const c=(t,e,n)=>{const i=document.getElementById(t);e.forEach((e=>{n>0&&("filter-size"===t&&i.insertAdjacentHTML("beforeend",`\n                    <label class="filter-size__label">\n                        <input class="filter-size__input" type="checkbox">\n                        <span class="filter-size__checkbox"></span>\n                        <span class="filter-size__text">${e}</span>\n                    </label>`),"filter-category"===t&&i.insertAdjacentHTML("beforeend",`\n                    <label class="filter-category__label">\n                        <input class="filter-category__input" type="checkbox">\n                        <div class="filter-category__checkbox">\n                            <span>${e}</span>\n                        </div>\n                    </label>`),"filter-gender"===t&&i.insertAdjacentHTML("beforeend",`\n                    <label class="filter-popular__label">\n                        <input class="filter-popular__input" type="checkbox">\n                        <span class="filter-popular__checkbox">\n                            ${e}\n                        </span>\n                    </label> `),n--)}))};c("filter-size",n,10),c("filter-category",i,10),c("filter-gender",r,10)})(),document.querySelector(".shop-content__inner").addEventListener("click",(t=>{if(t.target.closest(".product-link")){const e=t.target.closest(".product-item").querySelector(".product-item__id").textContent;sessionStorage.setItem("idProduct",e)}else t.target.closest(".basket-link")&&(t=>{const e=document.querySelector(".basket-sidebar"),n=document.querySelector(".basket-sidebar__inner"),i=JSON.parse(localStorage.getItem("products"))||[];if(n.addEventListener("click",(t=>{t.target.classList.contains("button-reomve")&&console.log(t.target.closest(".basket__item").querySelector(".basket__id"))})),t){const r={id:t.querySelector(".product-item__id").textContent,title:t.querySelector(".product-item__title").textContent,image:t.querySelector(".product-item__images").getAttribute("src"),price:t.querySelector(".product-item__new-price").textContent,category:t.querySelector(".product-item__category").textContent};i.forEach(((t,e)=>{t.id==r.id&&i.splice(e,1)})),i.push(r),localStorage.setItem("products",JSON.stringify(i)),n.innerHTML="",i.forEach((t=>{n.insertAdjacentHTML("beforeend",`\n            <article class="basket__item">\n                <img class="basket__image" src="${t.image}">\n                <h3 class="basket__title">${t.title}</h3>\n                <p class="basket__price">${t.price}</p>\n                <p class="basket__id" style="display: none">${t.id}</p>\n                <button type="button" class="basket__btn button-buy">Купить</button>\n                <button type="button" class="basket__btn button-reomve">Удалить</button>\n            </article>\n            `)})),i.length>=10&&document.querySelectorAll(".basket__image").forEach((t=>{t.style.width="100px"})),n.style.right="0%",e.style.height=n.scrollHeight+"px",n.scrollHeight>2500&&(e.style.height="2600px",e.style.overflowY="auto")}})(t.target.closest(".product-item"))}))})();